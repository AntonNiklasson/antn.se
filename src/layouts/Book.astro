---
import type { CollectionEntry } from "astro:content";
import PageLayout from "./PageLayout.astro";

type Props = CollectionEntry<"books">["data"] & { id: string };

const { id, title, author, cover, goodreadsUrl, rating } = Astro.props;
const slug = id.split("/")[0];
---

<PageLayout title={title}>
	<article class="relative space-y-8">
		<header class="space-y-6">
			<div class="flex gap-6">
				{
					cover && (
						<img
							src={cover}
							alt={`${title} cover`}
							class="h-48 w-32 rounded object-cover shadow-md"
						/>
					)
				}
				<div class="flex flex-1 flex-col justify-between">
					<div class="space-y-2">
						<h1 class="text-2xl">
							{title}
						</h1>
						<p class="text-lg text-gray-600">{author}</p>

						{
							rating && (
								<div class="text-sm text-gray-500">
									{"★".repeat(rating)}
									{"☆".repeat(5 - rating)}
								</div>
							)
						}
					</div>

					{
						goodreadsUrl && (
							<a
								href={goodreadsUrl}
								target="_blank"
								rel="noopener noreferrer"
								class="text-sm text-blue-600 hover:underline">
								View on Goodreads
							</a>
						)
					}
				</div>
			</div>
		</header>

		<div class="lg:prose-md prose prose-sm prose-headings:font-normal">
			<slot />
		</div>
	</article>

	<footer class="mt-24 flex justify-between border-t pt-4 text-sm font-bold text-gray-600">
		<a href="/books">Browse all books</a>
		<a
			href={`https://github.com/AntonNiklasson/antn.se/tree/main/src/content/books/${slug}/index.mdx`}
			>Edit this book</a
		>
	</footer>
</PageLayout>
