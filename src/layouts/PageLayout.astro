---
import { ViewTransitions } from "astro:transitions";
import BaseHead from "../components/BaseHead.astro";
import { fade } from "astro:transitions";

type Props = {
    title?: string;
    summary?: string;
    image?: string;
    expandHeader?: boolean;
};

const { title, summary, image, expandHeader = false } = Astro.props as Props;
---

<!doctype html>
<html lang="en">
	<head>
		<BaseHead
			title={`${title ?? "anton niklasson"} | antn.se`}
			description={summary}
			image={image}
		/>

		<!-- Google tag (gtag.js) -->
		<script
			type="text/partytown"
			async
			src="https://www.googletagmanager.com/gtag/js?id=G-XMNWG25QKL"></script>
		<script type="text/partytown">
			window.dataLayer = window.dataLayer || [];
			function gtag() {
				dataLayer.push(arguments);
			}
			gtag("js", new Date());
			gtag("config", "G-XMNWG25QKL");
		</script>
		<ViewTransitions />
	</head>

    <body transition:animate="none" class="relativew-full mx-auto">
        <header
            id="site-header"
            class="group sticky top-0 bg-white z-50 backdrop-blur-md text-lg transition-all duration-300 py-3 shadow data-[expanded=true]:py-6 data-[expanded=true]:shadow-none"
            data-expanded={expandHeader ? "true" : undefined}
        >
            <div class="max-w-[65ch] mx-auto flex items-center justify-between">
                <h1 class="text-left">
                    <a href="/" class="flex items-center gap-3">
                        <img id="site-avatar" src="/anton.jpg" alt="Anton Niklasson" class="rounded-full border border-gray-200 object-cover transition-all duration-300 w-8 h-8 group-data-[expanded=true]:w-12 group-data-[expanded=true]:h-12" />
                        <span id="site-name" class="transition-all duration-300 leading-none text-lg group-data-[expanded=true]:text-3xl">anton niklasson</span>
                    </a>
                </h1>

                <nav class="flex items-center gap-3">
                    <a
                        href="https://github.com/antonniklasson"
                        target="_blank"
                        rel="me noopener noreferrer"
                        class="p-1 rounded text-sm hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-300"
                        title="GitHub"
                        aria-label="GitHub"
                    >
                    github
                    </a>
                    <a
                        href="https://www.linkedin.com/in/antonniklasson"
                        target="_blank"
                        rel="me noopener noreferrer"
                        class="p-1 rounded text-sm hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-gray-300"
                        title="LinkedIn"
                        aria-label="LinkedIn"
                    >
                    linkedin
                    </a>
                </nav>
            </div>
        </header>

		<main transition:animate={fade({ duration: "0.4s" })} class="max-w-[65ch] mx-auto my-16">
			<slot />
		</main>
        {expandHeader && (
            <script>
                const header = document.getElementById('site-header');
                const onScroll = () => {
                    if (!header) {
                        return;
                    }

                    const expanded = window.scrollY <= 10;

                    if (expanded) header.setAttribute('data-expanded', 'true');
                    else header.removeAttribute('data-expanded');
                };
                onScroll();
                window.addEventListener('scroll', onScroll, { passive: true });
            </script>
        )}
	</body>
</html>
