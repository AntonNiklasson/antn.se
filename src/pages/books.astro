---
import { getCollection } from "astro:content";
import PageLayout from "../layouts/PageLayout.astro";

const books = await getCollection("books");
const sorted = books.sort((a, b) => a.data.title.localeCompare(b.data.title));
---

<PageLayout title="Books">
	<div class="space-y-8">
		<header class="space-y-2">
			<h1 class="text-2xl">Books</h1>
			<p class="text-gray-600">
				Books I've read, with notes and highlights from my reading.
			</p>
		</header>

		<ul class="relative space-y-6 pl-2">
			{
				sorted.map((book) => (
					<li>
						<a
							class="block rounded transition hover:opacity-80"
							href={`/books/${book.slug}`}>
							<div class="flex gap-4">
								{book.data.cover && (
									<img
										src={book.data.cover}
										alt={`${book.data.title} cover`}
										class="h-24 w-16 rounded object-cover shadow-sm"
									/>
								)}
								<div class="flex-1 space-y-1">
									<h2 class="text-md text-gray-700">{book.data.title}</h2>
									<p class="text-sm text-gray-500">{book.data.author}</p>
									{book.data.rating && (
										<div class="text-sm text-gray-400">
											{"★".repeat(book.data.rating)}
											{"☆".repeat(5 - book.data.rating)}
										</div>
									)}
								</div>
							</div>
						</a>
					</li>
				))
			}
		</ul>
	</div>
</PageLayout>
